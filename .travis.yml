language: python

branches:
  except:
    - /pyup\/.*/


dist: bionic

os: linux

services:
  - xvfb  # We might need to test GUIs https://docs.travis-ci.com/user/gui-and-headless-browsers/#using-services-xvfb.

jobs:
  fast_finish: true
  include:
    - &test-stable
      stage: PyInstaller stable release
      python: 3.7
      install:
        # Upgrade to the latest pip.
        - python -m pip install -U pip setuptools wheel

        # Install hooks-contrib
        - pip install -e .
        - pip install -r requirements-test.txt

        # Install PyInstaller
        - pip install pyinstaller
      script:
        - python -m PyInstaller.utils.run_tests -c pytest.ini

    - <<: *test-stable &test-develop
      stage: PyInstaller development version
      install:
        # Upgrade to the latest pip.
        - python -m pip install -U pip setuptools wheel

        # Install hooks-contrib
        - pip install -e .
        - pip install -r requirements-test.txt

        # Install PyInstaller
        - pip install https://github.com/pyinstaller/pyinstaller/archive/develop.tar.gz

    - <<: *test-stable
      python: 3.6
    - <<: *test-stable
        python: 3.5
    - <<: *test-develop
        python: 3.6
    - <<: *test-develop
        python: 3.5
